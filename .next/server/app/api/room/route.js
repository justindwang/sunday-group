(()=>{var e={};e.id=167,e.ids=[167],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5083:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>j,routeModule:()=>f,serverHooks:()=>G,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>v});var s={};r.r(s),r.d(s,{GET:()=>m,POST:()=>g,dynamic:()=>h});var a=r(6559),i=r(8088),n=r(7719),o=r(2190);let p={"sunday-group":{participants:[],groups:null,isGroupsFormed:!1}};function u(e){return p[e]||(p[e]={participants:[],groups:null,isGroupsFormed:!1}),p[e]}function l(e,t){let r=u(e);return void 0!==t.participants&&(r.participants=t.participants),void 0!==t.groups&&(r.groups=t.groups),void 0!==t.isGroupsFormed&&(r.isGroupsFormed=t.isGroupsFormed),r}let c=["Genesis","Exodus","Leviticus","Numbers","Deuteronomy","Joshua","Judges","Ruth","1 Samuel","2 Samuel","1 Kings","2 Kings","1 Chronicles","2 Chronicles","Ezra","Nehemiah","Esther","Job","Psalms","Proverbs","Ecclesiastes","Song of Solomon","Isaiah","Jeremiah","Lamentations","Ezekiel","Daniel","Hosea","Joel","Amos","Obadiah","Jonah","Micah","Nahum","Habakkuk","Zephaniah","Haggai","Zechariah","Malachi"],d=["Matthew","Mark","Luke","John","Acts","Romans","1 Corinthians","2 Corinthians","Galatians","Ephesians","Philippians","Colossians","1 Thessalonians","2 Thessalonians","1 Timothy","2 Timothy","Titus","Philemon","Hebrews","James","1 Peter","2 Peter","1 John","2 John","3 John","Jude","Revelation"];[...c,...d];let h="force-dynamic";async function m(e){let t=u(e.nextUrl.searchParams.get("roomId")||"sunday-group");return o.NextResponse.json(t)}async function g(e){try{let{roomId:t="sunday-group",action:r,data:s}=await e.json(),a=u(t);switch(r){case"addParticipant":{let{name:e,isWillingToLead:r,isBigGroupLeader:i}=s,n={id:s.id||Math.random().toString(36).substring(2,9),name:e,isWillingToLead:r,isBigGroupLeader:i},p=[...a.participants,n];return l(t,{participants:p}),o.NextResponse.json({success:!0,participant:n,participants:p})}case"removeParticipant":{let{participantId:e}=s,r=a.participants.filter(t=>t.id!==e);return l(t,{participants:r}),o.NextResponse.json({success:!0,participants:r})}case"formGroups":{let e=function(e){if(0===e.length)return[];let t=e.filter(e=>e.isWillingToLead),r=e.length,s=Math.floor(r/4),a=Math.ceil(r/7);if(t.length<a)return null;let i=Math.min(s,t.length);if((i=Math.max(i,a))%2!=0&&(i+=1),r/i<4)return null;let n=[...e].sort(()=>Math.random()-.5),o=n.filter(e=>e.isBigGroupLeader),p=n.filter(e=>e.isWillingToLead&&!e.isBigGroupLeader),u=n.filter(e=>!e.isWillingToLead&&!e.isBigGroupLeader),l=[],h=i/2;for(let e=0;e<i;e++){let t=e<h?"old":"new";l.push({id:`group-${e+1}`,name:function(e){let t="old"===e?c:d;return t[Math.floor(Math.random()*t.length)]}(t),participants:[],hasLeader:!1,testament:t})}for(let e=0;e<o.length;e++){let t=e%2==0?"old":"new",r=l.filter(e=>e.testament===t),s=l.findIndex(e=>e===r.sort((e,t)=>e.participants.length-t.participants.length)[0]);-1!==s&&(l[s].participants.push(o[e]),o[e].testament=t)}for(let e=0;e<l.length;e++)if(0===l[e].participants.length&&p.length>0){let t=p.shift();l[e].participants.push(t),l[e].hasLeader=!0,t.testament=l[e].testament}for(let e=0;e<p.length;e++){let t=e%2==0?"old":"new",r=l.filter(e=>e.testament===t),s=l.findIndex(e=>e===r.sort((e,t)=>e.participants.length-t.participants.length)[0]);-1!==s&&(l[s].participants.push(p[e]),l[s].hasLeader=!0,p[e].testament=t)}l.forEach(e=>{e.participants.some(e=>e.isBigGroupLeader)&&(e.hasLeader=!0)});for(let e=0;e<u.length;e++){let t=e%2==0?"old":"new",r=l.filter(e=>e.testament===t),s=l.findIndex(e=>e===r.sort((e,t)=>e.participants.length-t.participants.length)[0]);-1!==s&&(l[s].participants.push(u[e]),u[e].testament=t)}return l.forEach(e=>{e.participants.forEach(t=>{t.groupId=e.id})}),l}(a.participants);if(null===e)return o.NextResponse.json({success:!1,error:"Not enough willing leaders to form groups"});let r=a.participants.map(t=>{let r=e.find(e=>e.participants.some(e=>e.id===t.id));return r?{...t,groupId:r.id}:t});return l(t,{groups:e,participants:r,isGroupsFormed:!0}),o.NextResponse.json({success:!0,groups:e,participants:r,isGroupsFormed:!0})}case"resetGroups":{let e=a.participants.map(e=>({...e,groupId:void 0}));return l(t,{groups:null,participants:e,isGroupsFormed:!1}),o.NextResponse.json({success:!0,groups:null,participants:e,isGroupsFormed:!1})}case"resetRoom":return p[t]={participants:[],groups:null,isGroupsFormed:!1},o.NextResponse.json({success:!0,participants:[],groups:null,isGroupsFormed:!1});default:return o.NextResponse.json({success:!1,error:"Invalid action"},{status:400})}}catch(e){return console.error("API error:",e),o.NextResponse.json({success:!1,error:"Server error"},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/room/route",pathname:"/api/room",filename:"route",bundlePath:"app/api/room/route"},resolvedPagePath:"/Users/justin/github2/sunday-group/app/api/room/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:v,serverHooks:G}=f;function j(){return(0,n.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:v})}},6487:()=>{},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,580],()=>r(5083));module.exports=s})();