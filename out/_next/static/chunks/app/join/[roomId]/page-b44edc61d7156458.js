(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[810],{6:(e,t,r)=>{Promise.resolve().then(r.bind(r,4669))},4669:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var a=r(5155),o=r(2115),l=r(8999),n=r(5863);function i(e){let{roomId:t}=e,r=(0,l.useRouter)(),{addParticipant:i}=(0,n.n)(),[s,u]=(0,o.useState)(""),[d,c]=(0,o.useState)(!1),[m,p]=(0,o.useState)(!1),[g,h]=(0,o.useState)("");return(0,a.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center p-6",children:(0,a.jsxs)("div",{className:"w-full max-w-md bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Join Sunday Group"}),g&&(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6 text-center",children:g}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!s.trim())return void h("Please enter your name");p(!0);try{let e=i(s.trim(),d);r.push("/participant/sunday-group/".concat(e.id))}catch(e){h("Failed to join the room. Please try again."),p(!1)}},className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium mb-2",children:"Your Name"}),(0,a.jsx)("input",{type:"text",id:"name",value:s,onChange:e=>u(e.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your name",required:!0,disabled:m})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"isLeader",checked:d,onChange:e=>c(e.target.checked),className:"h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",disabled:m}),(0,a.jsx)("label",{htmlFor:"isLeader",className:"ml-3 block text-sm",children:"I am willing to lead a group"})]}),(0,a.jsx)("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",disabled:m,children:m?"Joining...":"Join Group"})]})]})})}},5863:(e,t,r)=>{"use strict";r.d(t,{RoomProvider:()=>i,n:()=>s});var a=r(5155),o=r(2115);let l=(0,o.createContext)(void 0),n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return t;try{return JSON.parse(e)}catch(e){return console.error("Failed to parse JSON from localStorage:",e),t}};function i(e){let{children:t}=e,[r]=(0,o.useState)("sunday-group"),[i,s]=(0,o.useState)(()=>n(localStorage.getItem("participants"),[])),[u,d]=(0,o.useState)(()=>n(localStorage.getItem("groups"),null)),[c,m]=(0,o.useState)(()=>"true"===localStorage.getItem("isGroupsFormed"));(0,o.useEffect)(()=>{localStorage.setItem("roomId",r),localStorage.setItem("participants",JSON.stringify(i)),localStorage.setItem("groups",u?JSON.stringify(u):""),localStorage.setItem("isGroupsFormed",c.toString())},[r,i,u,c]);let p=(e,t)=>{let r={id:Math.random().toString(36).substring(2,9),name:e,isWillingToLead:t};return s(e=>[...e,r]),r};return(0,a.jsx)(l.Provider,{value:{roomId:r,participants:i,groups:u,isGroupsFormed:c,addParticipant:p,addParticipantManually:(e,t)=>{p(e,t)},removeParticipant:e=>{s(t=>t.filter(t=>t.id!==e))},formGroups:()=>{let e=function(e){if(0===e.length)return[];let t=e.filter(e=>e.isWillingToLead),r=e.length,a=Math.floor(r/4),o=Math.ceil(r/6);if(t.length<o)return null;let l=Math.min(a,t.length);l=Math.max(l,o);let n=[...e].sort(()=>Math.random()-.5),i=n.filter(e=>e.isWillingToLead),s=n.filter(e=>!e.isWillingToLead),u=[];for(let e=0;e<l;e++)e<i.length&&u.push({id:"group-".concat(e+1),name:"Group ".concat(e+1),participants:[i[e]],hasLeader:!0});for(let e=l;e<i.length;e++)u[e%l].participants.push(i[e]);for(let e=0;e<s.length;e++){let t=u.map((e,t)=>({index:t,count:e.participants.length})).sort((e,t)=>e.count-t.count)[0].index;u[t].participants.push(s[e])}return u.forEach(e=>{e.participants.forEach(t=>{t.groupId=e.id})}),u}(i);return null!==e&&(d(e),m(!0),!0)},resetGroups:()=>{d(null),m(!1),s(e=>e.map(e=>({...e,groupId:void 0})))},resetRoom:()=>{s([]),d(null),m(!1)}},children:t})}function s(){let e=(0,o.useContext)(l);if(void 0===e)throw Error("useRoom must be used within a RoomProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(6)),_N_E=e.O()}]);